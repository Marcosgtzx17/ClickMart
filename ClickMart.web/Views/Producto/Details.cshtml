@model ClickMart.web.DTOs.ProductoDTOs.ProductoResponseDTO
@inject IConfiguration Config

@{
    ViewData["Title"] = "Detalle de producto";

    // Construimos la URL absoluta de la API y del endpoint de imagen
    var api = Config["ApiBaseUrl"] ?? "";
    if (!api.EndsWith("/")) api += "/";
    if (!api.EndsWith("/api/")) api = api.TrimEnd('/') + "/api/"; // normaliza
    var imgUrl = $"{api}producto/{Model.ProductoId}/imagen";

    // (Opcional) Flag para mostrar botón Editar solo si es admin
    var esAdmin = User.IsInRole("Admin") || User.IsInRole("Administrador") || User.IsInRole("adminitrador");
}

<h2>@ViewData["Title"]</h2>

<dl class="row">
    <dt class="col-sm-2">Id</dt>
    <dd class="col-sm-10">@Model.ProductoId</dd>

    <dt class="col-sm-2">Nombre</dt>
    <dd class="col-sm-10">@Model.Nombre</dd>

    <dt class="col-sm-2">Descripción</dt>
    <dd class="col-sm-10">@Model.Descripcion</dd>

    <dt class="col-sm-2">Talla</dt>
    <dd class="col-sm-10">@Model.Talla</dd>

    <dt class="col-sm-2">Precio</dt>
    <dd class="col-sm-10">$ @Model.Precio</dd>

    <dt class="col-sm-2">Marca</dt>
    <dd class="col-sm-10">@Model.Marca</dd>

    <dt class="col-sm-2">Stock</dt>
    <dd class="col-sm-10">@Model.Stock</dd>

    <dt class="col-sm-2">Categoría</dt>
    <dd class="col-sm-10">@Model.CategoriaId</dd>

    <dt class="col-sm-2">Distribuidor</dt>
    <dd class="col-sm-10">@Model.DistribuidorId</dd>
</dl>

@if (Model.TieneImagen)
{
    <div class="mb-3">
        <img class="img-thumbnail"
             src="@imgUrl"
             alt="imagen producto"
             style="max-width:300px" />
    </div>
}

@if (esAdmin)
{
    <a asp-action="Edit" asp-route-id="@Model.ProductoId" class="btn btn-warning">Editar</a>
}
<a asp-action="Index" class="btn btn-outline-secondary">Volver</a>
